\documentclass[a4paper,11pt]{article}
\author{Adrian. Hu}
\title{AP578:Support EBM in EPG TTCN3 FW}
\usepackage[dvipdfm,bookmarks,colorlinks]{hyperref}

\begin{document}
\maketitle
\tableofcontents

\section{AP Description}
Copy the description of AP578 which was submitted by Yumei Song:
\newline EPG shall report SGW Control Plane events in binary stream through TCP/IP connection to EBM \footnote{Event-Based Monitoring} Server. Since we use TTCN to do the function test, TTCN framework should update to simulate the EBM server and decode the binary stream sent by EPG.\\
Update this AP whenever you have any ideas:\\
\href{http://eteggsnit01.seln.ete.ericsson.se/redmine/issues/578}{AP578}.
\section{Reusability Analysis}
\subsection{EBM in CPG TTCN FW}
As we know,EBM ``server'' has been implemented in CPG TTCN test codes, CPG EBM uses TTCN to record (to generate binary file) and decode (to generate log file in ASCII) event stream in FT,so we hope we can use most parts of CPG EBM codes,let's dig out the secret of EBM in CPG:\\
\flushleft
\begin{enumerate}
\item CPG EBM mainly contains these parts:
\begin{description}
\item[TestPort] Which is located in: /vobs/cgw\_test/ttcn3/components/General\_config.ttcn.
\begin{verbatim}
    type port IPL4asp_EBM_PT message
    {
        in PDU_RECORD;
        in ASP_Event;
    }
    with {
        extension "user IPL4asp_PT
        in( ASP_RecvFrom -> PDU_RECORD : function(f_IPL4_decEBM);
        ASP_Event -> - : discard)"
    }

    type component MTC_CT extends BasicPTC_CT
    {
        // port TCPasp_EBM_PT EGW_EBM_PCO
        port IPL4asp_EBM_PT EGW_EBM_PCO;
        port Sync_PT    MTC_SNMP_FM_PCO;
    };
\end{verbatim}
\emph{Note:The EBM testport was put in MTC\_CT}.
\item[Message Types] which are located in: /vobs/cgw\_test/ttcn3/protocols/EBM\_Types.ttcn.This file was generated by script according to Ericsson proprietary bit-packed binary format based on a schema file ebm\_xml\_schema.xsd (that defines the structure of the XML file) and an XML file ebm\_event\_specification.xml.\\
    These two files:\\
    \textsf{ebm\_xml\_schema.xsd\\
    ebm\_event\_specification.xml.\\
    }
    are provided by SM.
\item[Message Templates] which are located in:\\/vobs/cgw\_test/ttcn3/protocols/EGW\_EBM\_Templates.ttcn.
\item[Message Handling Functions] which are located in:\\/vobs/cgw\_test/ttcn3/protocols/EGW\_EBM\_Functions.ttcn.
\end{description}
\item IPL4asp Test Port provided by ETH.
\item TITAN Runtime Configuration.
\end{enumerate}
\subsection{Copy Or Reconstruct}
Since we EPG TTCN Framwork has different architecture\footnote{State Machine \& Events Driven Mechanism} with CPG,\textcolor{red}{I don't think just copying CPG EBM codes is a good idea}.
\flushleft
\begin{enumerate}
\item Is that suitable to put EBM testport in MTC Component?
\item Is that OK to put scattered EBM message handling functions in testcases?It will break the structure of testcase making it lose readability.
\item The coding style is not consistent with our coding guide line.
\end{enumerate}
{\textcolor {blue}{
So,I prefer to set up EBM component-based events-driven message handling mechanism as we did in the past,\emph{but doing so will spend much more time}.
}
}\\
Finally I give expectation about reusability:\\
\flushleft
\begin{enumerate}
\item CPG EBM:
\begin{description}
\item[TestPort] The testport can be reused but we need put it in suitable place.
\item[Message Types] (\emph{Can totally be reused})
\item[Message Templates] (\emph{Can partial be reused})
\item[Message Handling Functions] Need to reform functions and altsepts,put them in suitable ttcn module.
\end{description}
\item IPL4asp Test Port provided by ETH(\emph{Can be reused}).
\item TITAN Runtime Configuration(\emph{Depends on our EPG test enrionment}).
\end{enumerate}
\section{Implementation Plan}
The implementation will be broken into two sub tasks:\\
\flushleft
\begin{enumerate}
\item TTCN Framework updates:\\
Time estimation:\textcolor{red}{\emph{4-5 weeks}}.\\
The update will have these files:
\newline \texttt{[New]}:\\
EBM\_Component.ttcn\\
EBM\_Decoder.ttcn\\
EBM\_Engine.ttcn\\
EBM\_Functions.ttcn\\
EBM\_Types.ttcn\\
EBM\_Templates.ttcn\\
GenerateDecoder.pl\\
xml2ttcn(awk script)
\newline \texttt{[Modifies]}:\\
templ\_common.cfg\\
templ\_hw.cfg
\item Integration with testcases:\\
Time estimation:\textcolor{red}{\emph{2-3 weeks}}.\\
Target: EBM related testcases. 
\end{enumerate}
\section{Reference}
\begin {thebibliography}{99}
\bibitem{bib1} Learn more about Feature:\\
\href{http://cdmweb.ericsson.se/WEBLINK/ViewDocs?DocumentName=316\%2F0363-1\%2FFCP111392\&Latest=true}{Feature Desc WP204 EBM}
\bibitem{bib2} A preliminary study of EBM in GGSN-MPG:\\
\href{http://cdmweb.ericsson.se/WEBLINK/ViewDocs?DocumentName=EAB\%2FFBA\%2FG-10\%3A0201\&Latest=true}{EBM solution for EPG}
\end{thebibliography}
\end{document}
